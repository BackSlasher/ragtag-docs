<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RAG-tag: Explained</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            background-color: #f8f9fa;
            color: #333;
        }
        .container {
            max-width: 960px;
            margin: 0 auto;
            padding: 20px;
        }
        header {
            background-color: #3498db;
            color: white;
            padding: 1rem 0;
            text-align: center;
        }
        header h1 {
            margin: 0;
            font-size: 2.5rem;
        }
        main {
            padding: 2rem 0;
        }
        h2 {
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            margin-top: 40px;
        }
        .image-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .image-gallery img {
            width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }
        .image-gallery img:hover {
            transform: scale(1.05);
        }
        pre {
            background-color: #2c3e50;
            color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
        }
        .website-link {
            display: block;
            text-align: center;
            margin: 40px 0;
            font-size: 1.2rem;
        }
    </style>
</head>
<body>

    <header>
        <div class="container">
            <h1>RAG-tag: Explained</h1>
        </div>
    </header>

    <main class="container">
        <p>Note how asking the same quesiton as different people (Carol the CSuite and Oscar from Operations) returns a differnt response, because Carol's question RAG can access documents that Oscar's can't.</p>

        <div class="image-gallery">
            <a href="oscar.png"><img src="oscar.png" alt="Oscar's View (Operations)"></a>
            <a href="carol.png"><img src="carol.png" alt="Carol's View (C-Suite)"></a>
        </div>

        <p>The policies that govern their behvior look like this:</p>
        <pre><code>{{- /* Allow if the user is in the C-suite group (ID 3) */ -}}
{{ if contains .GroupIDs 3 }}ALLOW{{ end }}

...

{{- /*
  Allow if a user's group membership grants them access to one of the document's categories.
*/ -}}

{{- /* Finance group can access Finance category */ -}}
{{- if and (contains .GroupIDs 1) (contains .CategoryIDs 1) }}ALLOW{{ end -}}

{{- /* Marketing group can access Marketing documents category */ -}}
{{- if and (contains .GroupIDs 2) (contains .CategoryIDs 3) }}ALLOW{{ end -}}

{{- /* Operations group can access Operation manuals category */ -}}
{{- if and (contains .GroupIDs 4) (contains .CategoryIDs 2) }}ALLOW{{ end -}}
</code></pre>

        <p>Which is Golang text templates, currently examining the document's category and the user's Group membership. The salary doc is indeed categorized as "finance" by the LLM, which means only finance and c-suite people can access it, because that's what the policies say.</p>

        <div class="image-gallery">
            <a href="document_list.png"><img src="document_list.png" alt="Document List View"></a>
        </div>

        <p>The categories are defined like this:</p>
        <pre><code>permissions=# select * from categories;
 id |        name         |                 description
----+---------------------+----------------------------------------------
  1 | Finance             | Documents related to the company's finances.
  2 | Operation manuals   | Manuals and guides for internal operations.
  3 | Marketing documents | Materials related to marketing and sales.
</code></pre>

        <p class="website-link">
            <a href="http://ragtag.backslasher.net/">Visit the live application</a>
        </p>

    </main>

</body>
</html>